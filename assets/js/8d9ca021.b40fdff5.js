"use strict";(self.webpackChunkmy_blogs=self.webpackChunkmy_blogs||[]).push([[679],{6370:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"machine-learning/data-preprocessing/data-preprocessing-python","title":"Data Preprocessing in Python","description":"Data Preprocessing tools","source":"@site/docs/machine-learning/data-preprocessing/data-preprocessing-python.md","sourceDirName":"machine-learning/data-preprocessing","slug":"/machine-learning/data-preprocessing/data-preprocessing-python","permalink":"/my-blogs/docs/machine-learning/data-preprocessing/data-preprocessing-python","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Pre-requisites","permalink":"/my-blogs/docs/machine-learning/data-preprocessing/intro"},"next":{"title":"Data Preprocessing Template","permalink":"/my-blogs/docs/machine-learning/data-preprocessing/data-preprocessing-python-template"}}');var r=t(4848),s=t(8453);const i={sidebar_position:2},o="Data Preprocessing in Python",l={},c=[{value:"Data Preprocessing tools",id:"data-preprocessing-tools",level:2},{value:"Importing the libraries",id:"importing-the-libraries",level:3},{value:"Importing the dataset",id:"importing-the-dataset",level:3},{value:"Taking care of missing data",id:"taking-care-of-missing-data",level:3},{value:"Encoding categorical data",id:"encoding-categorical-data",level:3},{value:"Encoding the independent variable",id:"encoding-the-independent-variable",level:4},{value:"Encoding the dependent variable",id:"encoding-the-dependent-variable",level:4},{value:"Splitting the dataset into Training set and Test set",id:"splitting-the-dataset-into-training-set-and-test-set",level:3},{value:"Feature Scaling",id:"feature-scaling",level:3}];function d(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"data-preprocessing-in-python",children:"Data Preprocessing in Python"})}),"\n",(0,r.jsx)(n.h2,{id:"data-preprocessing-tools",children:"Data Preprocessing tools"}),"\n",(0,r.jsx)(n.h3,{id:"importing-the-libraries",children:"Importing the libraries"}),"\n",(0,r.jsx)(n.p,{children:"We will need the following three libraries for most of the data pre-processing tasks"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Numpy - Allows us to work with arrays"}),"\n",(0,r.jsx)(n.li,{children:"Matplotlib - Allows us to plot charts and graphs"}),"\n",(0,r.jsx)(n.li,{children:"Pandas - Allows us to import the dataset and create matrix of features and dependent vectors."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\n"})}),"\n",(0,r.jsx)(n.h3,{id:"importing-the-dataset",children:"Importing the dataset"}),"\n",(0,r.jsxs)(n.p,{children:["Step 1: Import the dataset",(0,r.jsx)(n.br,{}),"\n","Step 2: Create matrix of ",(0,r.jsx)(n.strong,{children:"feature"})," and ",(0,r.jsx)(n.strong,{children:"dependent variable vectors"})]}),"\n",(0,r.jsx)(n.p,{children:"In any machine learing dataset we have two sets of data which are the features and the dependent vector variable."}),"\n",(0,r.jsx)(n.p,{children:"The features are the columns with which you are going to predict the dependent variable."}),"\n",(0,r.jsx)(n.p,{children:"The dependent variable is the column which you want the ML model to predict."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"dataset = pd.read_csv('Data.csv')\nX = dataset.iloc[:, :-1].values\ny = dataset.iloc[:, -1].values\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(X)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(y)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"taking-care-of-missing-data",children:"Taking care of missing data"}),"\n",(0,r.jsx)(n.p,{children:"One way to take care of missing data is to remove them. This is effective when you have a large dataset and only few of the data have missing values. Hence removing them will not impact the test data very much."}),"\n",(0,r.jsx)(n.p,{children:"Second way is to replace the missing data with average of the whole column."}),"\n",(0,r.jsxs)(n.p,{children:["For this we will use one of best data science library ",(0,r.jsx)(n.strong,{children:"ScikitLearn"})]}),"\n",(0,r.jsx)(n.p,{children:"It contains a lot of tools including lot of preprocessing tools."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from sklearn.impute import SimpleImputer\nimputer = SimpleImputer(missing_values=np.nan, strategy='mean')\nimputer.fit(X[:, 1:3])\nX[:, 1:3] = imputer.transform(X[:, 1:3])\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(X)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"encoding-categorical-data",children:"Encoding categorical data"}),"\n",(0,r.jsx)(n.p,{children:"The categorical data may most probably contain string data. So it is necessary to encode this data into numerical format for the machine learning model to interpret the result accurately."}),"\n",(0,r.jsxs)(n.p,{children:["One of the most popular method is ",(0,r.jsx)(n.strong,{children:"One-hot encoding"})]}),"\n",(0,r.jsxs)(n.p,{children:["If the column is categorized only into two values we can simply represent the values as binary format 1/0. This can be achieved by using ",(0,r.jsx)(n.strong,{children:"Label Encoding"})]}),"\n",(0,r.jsx)(n.h4,{id:"encoding-the-independent-variable",children:"Encoding the independent variable"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nct = ColumnTransformer(transformers=[('encoder', OneHotEncoder(), [0])], remainder='passthrough')\nX = np.array(ct.fit_transform(X))\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(X)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"encoding-the-dependent-variable",children:"Encoding the dependent variable"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ny = le.fit_transform(y)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(y)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"splitting-the-dataset-into-training-set-and-test-set",children:"Splitting the dataset into Training set and Test set"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 1)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(X_train)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(X_test)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(y_train)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(y_test)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"feature-scaling",children:"Feature Scaling"}),"\n",(0,r.jsx)(n.p,{children:"Helps put all our features on the same scale."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train[:, 3:] = sc.fit_transform(X_train[:, 3:])\nX_test[:, 3:] = sc.transform(X_test[:, 3:])\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(X_train)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"print(X_test)\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var a=t(6540);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);